---
title: "Nuclei Isolation Tutorial for the Adult Kidney"
author: "Deborah Sohn"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: 
  html_document:
    toc: yes
    toc_depth: 5
    toc_float: true
    number_sections: true
    df_print: paged
    code_folding: hide
    highlight: pygments
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
set.seed((12345))
```




# Introduction:
The purpose of this tutorial is to provide a step-by-step guide to isolate nuclei from flash-frozen tissue for single nucleus RNA sequencing. Nuclei Isolation is the first step in many novel techniques including snNRAseq, single-nucleus assay for transposase-accessible chromatin sequencing, epigenomic analysis. Although based off of the 10X Genetics Chromium Nuclei Isolation Protocol, this tutorial is specifically for the use of kidney tissue for snRNAseq and includes alterations to maximize yield and quality. This tutorial will also include a guide on how to assess and grade the quality of the isolated nuclei as well as next steps after the initial isolation. 




# Resources from 10X Genetics:

![](`r here::here("NI 10X File", "D.png")`)

[Link to 10X Protocol, starts on Page 25](https://cdn.10xgenomics.com/image/upload/v1660261285/support-documents/CG000505_Chromium_Nuclei_Isolation_Kit_UG_RevA.pdf)

Edited Visual Diagram of Protocol, with inserted notes for easy reading:



# Protocol:
The protocol includes four main steps: buffer set up, lysis, debris removal, and resuspension. 

## Buffer Set-Up

Table of Buffers:
```{r class.source = 'fold-show'}
#install.packages("openxlsx")
#install.packages("here")
    library(openxlsx)
    library(here)
```

```{r class.source = 'fold-show'}
library(openxlsx)
library(dplyr)
library(knitr)
library(kableExtra)
library(here)

# Read the data
df <- read.xlsx(here("NI 10X File", "buffers.xlsx"))
url1 <- df$url1  


df2 <- df %>% select(-url1) %>% 
  mutate_all(~ replace(., is.na(.), ""))


df3 <- df2 %>%
  kbl(booktabs = T, align = "c") %>%
  kable_styling() %>%
  column_spec(1, bold = T, color = "#990000") %>%  
  column_spec(1:ncol(df2), width = "12em") %>%    # Set all columns to same width
  row_spec(1:nrow(df2), align = "c" ) %>%    # Bold the top row (header) with red color
  row_spec(3:nrow(df2), align = "c")               # Align the rest of the rows to center


df3
```


![](`r here::here("NI 10X File", "E.png")`)

![](`r here::here("NI 10X File", "F.png")`)

<input type="checkbox"> 1. Start with the Wash and Resuspension Buffer, which is composed of the 1X PBS and 10% BSA solutions that are not included in the kit. Generally, make a stock of 100 mL of each and keep chilled at 4 degrees Celcius. Refer to the table above and the instructions for components and amounts.

  <input type="checkbox"> 1X PBS: Dilute 10 mL into 90 mL of Ultra-Pure Water. Invert to mix thoroughly.  
  <input type="checkbox"> 10% BSA: 10 grams of powder BSA to 100 mL of Ultra-Pure Water. Mix gently by swirling to prevent excess frothing.

<input type="checkbox"> 2. Next, retrieve all components of the 10X Nuclei Isolation Kit, which should include the Lysis Reagent, Debris Removal Reagent, Reducing Agent B, Surfactant A, and RNAse Inhibitor. Also retrieve the Sample Dissociation Tube from the room temperature Consumables portion. 

<input type="checkbox"> 3. Place everything except for the Reducing Agent B on ice and begin to prepare the buffers. After Reducing Agent B thaws and everything is briefly vortexed, begin preparing the buffers.

<input type="checkbox"> 4. Per reaction, the Lysis Buffer requires 550 µl Lysis reagent, 0.55 µl Reducing Agent B, and 5.5 µl Surfactant A. Per reaction, the Debris Removal Buffer requires 550 µl Debris Removal Reagent and 0.55 µl of the Reducing Agent B. Per reaction, the Wash and Resuspension Buffer requires 2,887.5 µl 1X PBS, 330 µl 10% BSA, and 82.5 µl of RNase Inhibitor for sequencing. 

<input type="checkbox"> 5. Keep all completed buffers labeled and on ice. Pre-chill the centrifuge to 4 degrees C.

## Main Procedure
<input type="checkbox"> 1. Retrieve flash frozen half kidney from the -80 degrees storage. While frozen, use tweezers or scissors to remove the kideny and place it in a pre-chilled Sample Dissociation Tube. 

<input type="checkbox"> 2. Add 200 µl of the Lysis Buffer and wait for the kidney to mostly thaw. Using sterile scissors, chop up the kidney into small pieces, closing and opening scissors at least 50 times. 

<input type="checkbox"> 3. Then using the green pestle provided in the room-temperature pack, grind up the tissue, pressing down and twisting at least 20 times or until the solution is smooth with no visible chunks. 

<input type="checkbox"> 4. Next, add 300 µl of the Lysis buffer and pipette up and down, making sure that there are no chunks that block the pipette tip. Incubate the solution on ice for 8 minutes, starting the timer after completing the grinding step.

<input type="checkbox"> 5. Next, pipette the dissociated tissue solution onto the Nuclei Isolation Column in the collection Tube (both included in room temperature Consummables) and spin in the centrifuge for 16,000 rcf, 20 sec, at 4 degrees C. Make sure that this cycle is evenly balanced in the centrifuge, because of the high speed.

<input type="checkbox"> 6. After the cycle ends, discard the column and vortex the flow-through for 10 seconds to resuspend the nuclei. Then spin in the centrifuge at 700 rcf, 3 min, 4 degrees C. Make sure that when placing the Nuclei Isolation Column, position it within the centrifuge so that the hinge of the lid points out, the front tab facing in. This will make it easier to find the pellet and avoid losing nuclei.

<input type="checkbox"> 7. Next, remove the supernatent, being careful to avoid the pellet and angling the pipette tip away from the hinge side of the column. 

<input type="checkbox"> 8. Resuspend the pellet with 500 µl of the Debris Removal Buffer. Spin at 700 rcf for 10 minutes at 4 degrees C. While waiting, mix the final Resuspension Buffer, which should be 0.04% BSA in PBS. 

<input type="checkbox"> 9. Remove the supernatant again and resuspend in 1 mL of the Wash and Resuspension Buffer. Spin at 500 rcf for 5 minutes, 4 degrees C. Remove supernatant, resuspend again in 1 mL of Wash and Resuspension Buffer. Spin again at 500 rcf for 5 minutes, 4 degrees C. 

<input type="checkbox"> 10. Finally, resuspend the. nuclei pellet in 500 µl of the Final Wash and Resuspension Buffer (0.04% BSA). Vortex the solution for 3 seconds and let it sit undisturbed for 15 minutes.

Now, depending on QC or following uses, use the concentrated solution.


## Nuclei Count with Light Microscope:

With the nuclei solution, add 2 µl to 18 µl of Trypan Blue, pipetting up and down into the TB at least 10 times to mix thoroughly. Note that while Trypan Blue does not aggregate in whole cells, the compound does aggregate within the exposed nuclei, which is what we will be checking for. 
Add 10 µl to one of the wells on a hemocytometer, making sure the solution fills the space. Observe on a light microscope, counting to get an approximation and assessment of nuclei quality.


Microscope used in this procedure: 

[link to hemocytometer counter app](https://apps.apple.com/us/app/cell-counter-calculator/id6670227470)



From this procedure, the average expected nuclei concentration count is: 500 nuclei per microliter 
This is approximately 20 to 40 nuclei per quadrant in the hemocytometer.



## Nuclei Quality Check:

Priority Check: 


1. No clumps, with an even distribution


2. Quality: 

A grade Nuclei: Good, circular shape with no blebbing, halo of Trypan Blue around the edges that suggest an undisturbed nuclear envelope. No aggregation. 
  
  
B grade Nuclei: Slightly irregular shapes, still has the halo but less bright or more uneven 
  
C grade Nuclei: Losing more of normal shape, small blebbing, paler color

D/F grade Nuclei: Complete loss of structure, no blue halo, aggregates

Example of a graded sample: 

![](`r here::here("NI 10X File", "A.png")`)





Example of grading with reasoning. Note: this is an image of an aggregate that was included because of a wide variety of quality, but as a general rule aggregates indicate a low quality overall sample. 

![](`r here::here("NI 10X File", "B.png")`)



Example of a sample viewed at 10x and 40x, grading the individual nuclei quality is easier at 40x but it is recommended to conduct overall sample quality checks at 10x magnification.

  
![](`r here::here("NI 10X File", "C.png")`)




